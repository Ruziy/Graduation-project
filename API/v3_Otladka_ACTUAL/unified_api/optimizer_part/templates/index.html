<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ü–∞–Ω–µ–ª—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- –í–ê–ñ–ù–û: url_for('static', ...) —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –≤ /optimizer/static/... -->
  <link rel="stylesheet" href="{{ url_for('static', path='/styles.css') }}" />
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</div>
    </div>

    <div class="card">
      <!-- –ë–¨–Å–ú –ù–ê –ü–û–î-–ü–†–ò–õ–û–ñ–ï–ù–ò–ï: /optimizer/run-mode-ui -->
      <form method="post" action="{{ url_for('run_mode_ui') }}">
        <div class="row">
          <label for="mode" class="label">
            <span class="material-icons icon">tune</span>
            –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
          </label>
          <select name="mode" id="mode">
            <option value="1">üîß –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</option>
            <option value="2">üß† –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</option>
            <option value="3">üß™ –ó–∞–ø—É—Å–∫ base.py (–≤—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å)</option>
          </select>
        </div>

        <div id="calibration-fields" class="stack">
          <label for="fps_threshold" class="label">FPS –ø–æ—Ä–æ–≥</label>
          <input type="number" name="fps_threshold" id="fps_threshold" step="0.1" value="10.0" />

          <label for="cpu_threshold" class="label">CPU –ø–æ—Ä–æ–≥ (%)</label>
          <input type="number" name="cpu_threshold" id="cpu_threshold" step="0.1" value="50.0" />
        </div>

        <div class="controls">
          <button type="submit" id="runBtn">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
        </div>
      </form>
    </div>

    <div class="card">
      <!-- /optimizer/select-model-ui -->
      <form method="post" action="{{ url_for('select_model_ui') }}">
        <div class="row">
          <label for="model_name" class="label">
            <span class="material-icons icon">model_training</span>
            –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏
          </label>
          <select name="model_name" id="model_name">
            <option value="yolov8">YOLOv8</option>
            <option value="dlib">Dlib</option>
            <option value="mtcnn">MTCNN</option>
            <option value="insightface">InsightFace</option>
            <option value="retinaface">RetinaFace</option>
            <option value="mediapipe">MediaPipe</option>
            <option value="haarcascade">Haar Cascade</option>
            <option value="ssd">SSD</option>
          </select>
        </div>

        <div class="controls">
          <button type="submit">‚úÖ –í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å</button>
        </div>
      </form>

      {% if result %}
      <div class="result">
        {% if result.status %}
          <div><strong>–°—Ç–∞—Ç—É—Å:</strong> {{ result.status }}</div>
        {% endif %}
        {% if result.output %}
          <pre>{{ result.output }}</pre>
        {% else %}
          <pre>{{ result }}</pre>
        {% endif %}
      </div>
      {% endif %}

      <p class="muted">
        üîò –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:
        <strong>{{ current_model if current_model else "‚Äî" }}</strong>
      </p>
    </div>
  </div>

  <!-- –°–∫—Ä–∏–ø—Ç —Å—Ç—Ä–æ–≥–æ –≤ –∫–æ–Ω—Ü–µ body -->
  <script>
  (function(){
    const byId = id => document.getElementById(id);

    function toggleCalibrationFields(){
      const mode = byId('mode')?.value;
      const wrap = byId('calibration-fields');
      if(!wrap) return;
      wrap.style.display = (mode === '1') ? '' : 'none';
    }

    document.addEventListener('DOMContentLoaded', () => {
      const modeEl = byId('mode');
      if(modeEl){
        modeEl.addEventListener('change', toggleCalibrationFields);
      }
      toggleCalibrationFields();
    });
  })();
  </script>
</body>
</html>
