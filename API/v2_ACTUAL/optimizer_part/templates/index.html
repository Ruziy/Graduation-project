<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ü–∞–Ω–µ–ª—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</div>
    </div>

    <div class="card">
      <form method="post" action="/run-mode-ui">
        <div class="row">
          <label for="mode" class="label">
            <span class="material-icons icon">tune</span> –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
          </label>
          <select name="mode" id="mode">
            <option value="1">üîß –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</option>
            <option value="2">üß† –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</option>
          </select>
        </div>

        <div id="calibration-fields" class="stack">
          <label for="fps_threshold" class="label">FPS –ø–æ—Ä–æ–≥</label>
          <input type="number" name="fps_threshold" id="fps_threshold" step="0.1" value="10.0" />

          <label for="cpu_threshold" class="label">CPU –ø–æ—Ä–æ–≥ (%)</label>
          <input type="number" name="cpu_threshold" id="cpu_threshold" step="0.1" value="50.0" />
        </div>

        <div class="controls">
          <button type="submit" id="runBtn">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
        </div>
      </form>
    </div>

    <div class="card">
      <form method="post" action="/select-model-ui">
        <div class="row">
          <label for="model_name" class="label">
            <span class="material-icons icon">model_training</span> –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏
          </label>
          <select name="model_name" id="model_name">
            <option value="yolov8">YOLOv8</option>
            <option value="dlib">Dlib</option>
            <option value="mtcnn">MTCNN</option>
            <option value="insightface">InsightFace</option>
            <option value="retinaface">RetinaFace</option>
            <option value="mediapipe">MediaPipe</option>
            <option value="haarcascade">Haar Cascade</option>
            <option value="ssd">SSD</option>
          </select>
        </div>

        <div class="controls">
          <button type="submit">‚úÖ –í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å</button>
        </div>
      </form>

      {% if result %}
      <div class="result">
        <strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong><br />
        {{ result }}
      </div>
      {% endif %}

      {% if current_model %}
      <p class="muted">üîò –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å: <strong>{{ current_model }}</strong></p>
      {% endif %}
    </div>
  </div>

  <!-- –°–∫—Ä–∏–ø—Ç —Å—Ç—Ä–æ–≥–æ –≤ –∫–æ–Ω—Ü–µ body –≤ —Å—Ç–∏–ª–µ —ç—Ç–∞–ª–æ–Ω–∞ -->
  <script>
  (function(){
    const log = (...a) => console.log('[UI]', ...a);
    const byId = id => document.getElementById(id);

    function toggleCalibrationFields(){
      const mode = byId('mode')?.value;
      const wrap = byId('calibration-fields');
      if(!wrap) return;
      wrap.style.display = (mode === '1') ? '' : 'none';
    }

    document.addEventListener('DOMContentLoaded', () => {
      log('DOM loaded');
      const modeEl = byId('mode');
      if(modeEl){
        modeEl.addEventListener('change', toggleCalibrationFields);
      }
      toggleCalibrationFields();
    });
  })();
  </script>
</body>
</html>
